(self.webpackChunkwebxr_asteroids=self.webpackChunkwebxr_asteroids||[]).push([[179],{752:(e,t,s)=>{"use strict";const i=s(769);document.addEventListener("DOMContentLoaded",(e=>{new i.Game}))},585:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Asteroid=void 0;const i=s(212),o=s(47),r=s(882);class a extends i.Object3D{constructor(){super(),(new o.GLTFLoader).load("assets/models/asteroid.glb",(e=>{let t=e.scene.children[0];this.add(t.clone()),this.setRandomPosition()}))}setRandomPosition(){this.position.set(r.Util.random(-3,3),r.Util.random(0,3),r.Util.random(-4,-2)),this.rotation.set(r.Util.random(0,Math.PI),r.Util.random(0,Math.PI),r.Util.random(0,Math.PI))}}t.Asteroid=a},820:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsteroidGroup=void 0;const i=s(212),o=s(585);class r extends i.Group{constructor(e){super(),this.gameView=e,this.allowedDistance=.5,this.rotationIncrement=.01,this.speed=.001,this.speedInitial=.001,this.speedIncrement=5e-4}moveTowardsCamera(e){this.children.forEach((t=>{t.position.set(t.position.x+(e.position.x-t.position.x)*this.speed,t.position.y+(e.position.y-t.position.y)*this.speed,t.position.z+(e.position.z-t.position.z)*this.speed),t.rotation.set(t.rotation.x+this.rotationIncrement,t.rotation.y+this.rotationIncrement,t.rotation.z+this.rotationIncrement)}))}createAsteroid(){let e=new o.Asteroid;e.setRandomPosition(),this.add(e)}checkIfAsteroidToClose(e){this.children.forEach((t=>{t.position.distanceTo(e.position)<this.allowedDistance&&(this.gameView.game.playerLostALive(),this.remove(t))}))}update(e){this.moveTowardsCamera(e),this.checkIfAsteroidToClose(e)}updateEachSecond(){this.createAsteroid(),this.speed+=this.speedIncrement}}t.AsteroidGroup=r},387:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Earth=void 0;const i=s(212);class o extends i.Mesh{constructor(){let e=new i.SphereGeometry(1,32,32),t=new i.MeshPhongMaterial;t.map=(new i.TextureLoader).load("assets/img/earth.jpg"),t.bumpMap=(new i.TextureLoader).load("assets/img/earthBump.jpg"),t.bumpScale=.05,t.specularMap=(new i.TextureLoader).load("assets/img/earthSpec.jpg"),t.specular=new i.Color("grey"),super(e,t),this.position.y=1.6,this.position.z=3,this.rotationSpeed=.002}update(){this.rotation.y+=this.rotationSpeed}}t.Earth=o},769:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const i=s(268),o=s(724),r=s(237);t.Game=class{constructor(){this.gameState=i.GameState.LOADING,this.gameOver=5,this.lifesLost=0,this.score=0,this.gameView=new r.GameView(this),this.gameSound=new o.GameSound,this.gameState=i.GameState.READY}restart(){this.lifesLost=0,this.score=0,this.gameView.asteroidGroup.speed=this.gameView.asteroidGroup.speedInitial,this.gameState=i.GameState.PLAYING}playerScored(){this.gameSound.fire(),this.score++}playerLostALive(){this.gameSound.explosion(),this.lifesLost++}checkIfPlayerLost(){this.lifesLost>=this.gameOver&&this.playerLost()}playerLost(){this.gameState=i.GameState.ENDED,this.gameSound.lost(),this.gameView.asteroidGroup.clear()}buttonPressed(){this.gameState===i.GameState.READY&&(this.gameState=i.GameState.PLAYING),this.gameState===i.GameState.ENDED&&this.restart()}}},724:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameSound=void 0;const i=s(766);t.GameSound=class{constructor(){this.lostAudio=new i.Howl({src:["assets/sound/lost.wav"],volume:.5}),this.fireAudio=new i.Howl({src:["assets/sound/fire.wav"],volume:.5}),this.explosionAudio=new i.Howl({src:["assets/sound/explosion.wav"],volume:.5}),this.backgroundAudio=new i.Howl({src:["assets/sound/background.mp3"],volume:.3,loop:!0,autoplay:!0})}lost(){this.lostAudio.play()}fire(){this.fireAudio.play()}explosion(){this.explosionAudio.play()}}},268:(e,t)=>{"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.GameState=void 0,(s=t.GameState||(t.GameState={}))[s.LOADING=0]="LOADING",s[s.READY=1]="READY",s[s.PLAYING=2]="PLAYING",s[s.ENDED=3]="ENDED"},237:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameView=void 0;const i=s(212),o=s(146),r=s(219),a=s(211),n=s(886),d=s(387),h=s(820),c=s(268);t.GameView=class{constructor(e){this.game=e,this.scene=new i.Scene,this.camera=new i.PerspectiveCamera(50,window.innerWidth/window.innerHeight,.1,100),this.camera.position.set(0,1.6,0),this.renderer=new i.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.outputEncoding=i.sRGBEncoding,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=i.PCFSoftShadowMap,document.body.appendChild(this.renderer.domElement);let t=new i.HemisphereLight(6316128,4210752);this.scene.add(t),this.clock=new i.Clock,this.prevTime=0,this.controls=new a.PointerLockControls(this.camera,this.renderer.domElement),window.addEventListener("click",(()=>{})),this.stats=r.default(),document.body.appendChild(this.stats.dom),this.raycaster=new i.Raycaster,this.workingMatrix=new i.Matrix4,this.workingVector=new i.Vector3,this.initScene(),this.setupXR(),window.addEventListener("resize",this.onResize.bind(this),!1),this.renderer.setAnimationLoop(this.update.bind(this))}initScene(){this.scene.background=(new n.Sky).loadSky(),this.earth=new d.Earth,this.scene.add(this.earth),this.asteroidGroup=new h.AsteroidGroup(this),this.scene.add(this.asteroidGroup)}setupXR(){this.renderer.xr.enabled=!0;let e=o.VRButton.createButton(this.renderer);document.body.appendChild(e),this.renderer.xr.getController(0).addEventListener("selectstart",(()=>{this.game.buttonPressed()}))}handleCameraMovement(){let e=this.renderer.xr.getCamera(this.camera);this.workingMatrix.identity().extractRotation(e.matrixWorld),this.raycaster.ray.origin.setFromMatrixPosition(e.matrixWorld),this.raycaster.ray.direction.set(0,0,-1).applyMatrix4(this.workingMatrix),this.raycaster.intersectObjects(this.asteroidGroup.children,!0).forEach((e=>{this.game.playerScored();let t=e.object.parent.parent.parent.parent.parent.parent;this.asteroidGroup.remove(t)}))}update(){if(this.stats.update(),this.earth.update(),this.renderer.xr.getSession()&&this.game.gameState===c.GameState.PLAYING){this.game.checkIfPlayerLost();let e=this.renderer.xr.getCamera(this.camera);this.clock.getElapsedTime()-this.prevTime>1&&(this.prevTime=this.clock.getElapsedTime(),this.asteroidGroup.updateEachSecond()),this.handleCameraMovement(),this.asteroidGroup.update(e)}this.renderer.render(this.scene,this.camera)}onResize(){this.renderer.setSize(window.innerWidth,window.innerHeight)}}},886:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sky=void 0;const i=s(212);class o extends i.CubeTextureLoader{constructor(){super()}loadSky(){let e=new Array(6).fill("assets/img/sky.jpg");return this.load(e)}}t.Sky=o},882:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0,t.Util=class{static random(e,t){return Math.random()*(t-e)+e}}}},0,[[752,666,216]]]);