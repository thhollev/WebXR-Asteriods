(self.webpackChunkwebxr_asteroids=self.webpackChunkwebxr_asteroids||[]).push([[179],{752:(e,t,i)=>{"use strict";const s=i(769);document.addEventListener("DOMContentLoaded",(e=>{new s.Game}))},585:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Asteroid=void 0;const s=i(212),o=i(47),r=i(882);class a extends s.Object3D{constructor(){super(),(new o.GLTFLoader).load("assets/models/asteroid.glb",(e=>{let t=e.scene.children[0];this.add(t.clone()),this.setRandomPosition()}))}setRandomPosition(){this.position.set(r.Util.random(-3,3),r.Util.random(0,3),r.Util.random(-4,-2)),this.rotation.set(r.Util.random(0,Math.PI),r.Util.random(0,Math.PI),r.Util.random(0,Math.PI))}}t.Asteroid=a},820:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsteroidGroup=void 0;const s=i(212),o=i(585);class r extends s.Group{constructor(e){super(),this.gameView=e,this.allowedDistance=.5,this.rotationIncrement=.01,this.speed=.001,this.speedInitial=.001,this.speedIncrement=5e-4}moveTowardsCamera(e){this.children.forEach((t=>{t.position.set(t.position.x+=(e.position.x-t.position.x)*this.speed,t.position.y+=(e.position.y-t.position.y)*this.speed,t.position.z+=(e.position.z-t.position.z)*this.speed),t.rotation.set(t.rotation.x+=this.rotationIncrement,t.rotation.y+=this.rotationIncrement,t.rotation.z+=this.rotationIncrement)}))}createAsteroid(){let e=new o.Asteroid;e.setRandomPosition(),this.add(e)}checkIfAsteroidToClose(e){this.children.forEach((t=>{t.position.distanceTo(e.position)<this.allowedDistance&&(this.gameView.game.playerLostALive(),this.remove(t))}))}update(e){this.moveTowardsCamera(e),this.checkIfAsteroidToClose(e)}updateEachSecond(){this.createAsteroid(),this.speed+=this.speedIncrement}}t.AsteroidGroup=r},387:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Earth=void 0;const s=i(212);class o extends s.Mesh{constructor(){let e=new s.SphereGeometry(1,32,32),t=new s.MeshPhongMaterial;t.map=(new s.TextureLoader).load("assets/img/earth.jpg"),t.bumpMap=(new s.TextureLoader).load("assets/img/earthBump.jpg"),t.bumpScale=.05,t.specularMap=(new s.TextureLoader).load("assets/img/earthSpec.jpg"),t.specular=new s.Color("grey"),super(e,t),this.position.y=1.6,this.position.z=3,this.rotationSpeed=.002}update(){this.rotation.y+=this.rotationSpeed}}t.Earth=o},769:function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(o,r){function a(e){try{d(s.next(e))}catch(e){r(e)}}function n(e){try{d(s.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,n)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const o=i(268),r=i(724),a=i(237);t.Game=class{constructor(){this.gameState=o.GameState.LOADING,this.gameOver=5,this.lifesLost=0,this.score=0,this.gameView=new a.GameView(this),this.gameSound=new r.GameSound,this.gameState=o.GameState.READY}restart(){this.lifesLost=0,this.score=0,this.gameView.asteroidGroup.speed=this.gameView.asteroidGroup.speedInitial,this.gameState=o.GameState.PLAYING}playerScored(){return s(this,void 0,void 0,(function*(){this.gameSound.fire(),this.score++}))}playerLostALive(){return s(this,void 0,void 0,(function*(){this.gameSound.explosion(),this.lifesLost++}))}checkIfPlayerLost(){return s(this,void 0,void 0,(function*(){this.lifesLost>=this.gameOver&&this.playerLost()}))}playerLost(){return s(this,void 0,void 0,(function*(){this.gameState=o.GameState.ENDED,this.gameSound.lost(),this.gameView.asteroidGroup.clear()}))}buttonPressed(){this.gameState===o.GameState.READY&&(this.gameState=o.GameState.PLAYING),this.gameState===o.GameState.ENDED&&this.restart()}}},724:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GameSound=void 0;const s=i(766);t.GameSound=class{constructor(){this.lostAudio=new s.Howl({src:["assets/sound/lost.wav"],volume:.5}),this.fireAudio=new s.Howl({src:["assets/sound/fire.wav"],volume:.5}),this.explosionAudio=new s.Howl({src:["assets/sound/explosion.wav"],volume:.5}),this.backgroundAudio=new s.Howl({src:["assets/sound/background.mp3"],volume:.3,loop:!0,autoplay:!0})}lost(){this.lostAudio.play()}fire(){this.fireAudio.play()}explosion(){this.explosionAudio.play()}}},268:(e,t)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.GameState=void 0,(i=t.GameState||(t.GameState={}))[i.LOADING=0]="LOADING",i[i.READY=1]="READY",i[i.PLAYING=2]="PLAYING",i[i.ENDED=3]="ENDED"},237:function(e,t,i){"use strict";var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(o,r){function a(e){try{d(s.next(e))}catch(e){r(e)}}function n(e){try{d(s.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,n)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GameView=void 0;const o=i(212),r=i(146),a=i(219),n=i(211),d=i(886),h=i(387),c=i(820),u=i(268);t.GameView=class{constructor(e){this.game=e,this.scene=new o.Scene,this.camera=new o.PerspectiveCamera(50,window.innerWidth/window.innerHeight,.1,100),this.camera.position.set(0,1.6,0),this.renderer=new o.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.outputEncoding=o.sRGBEncoding,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=o.PCFSoftShadowMap,document.body.appendChild(this.renderer.domElement);let t=new o.HemisphereLight(6316128,4210752);this.scene.add(t),this.clock=new o.Clock,this.prevTime=0,this.controls=new n.PointerLockControls(this.camera,this.renderer.domElement),window.addEventListener("click",(()=>{})),this.stats=a.default(),document.body.appendChild(this.stats.dom),this.raycaster=new o.Raycaster,this.workingMatrix=new o.Matrix4,this.workingVector=new o.Vector3,this.initScene(),this.setupXR(),window.addEventListener("resize",this.onResize.bind(this),!1),this.renderer.setAnimationLoop(this.update.bind(this))}initScene(){this.scene.background=(new d.Sky).loadSky(),this.earth=new h.Earth,this.scene.add(this.earth),this.asteroidGroup=new c.AsteroidGroup(this),this.scene.add(this.asteroidGroup)}setupXR(){this.renderer.xr.enabled=!0;let e=r.VRButton.createButton(this.renderer);document.body.appendChild(e),this.renderer.xr.getController(0).addEventListener("selectstart",(()=>{this.game.buttonPressed()}))}handleCameraMovement(){return s(this,void 0,void 0,(function*(){let e=this.renderer.xr.getCamera(this.camera);this.workingMatrix.identity().extractRotation(e.matrixWorld),this.raycaster.ray.origin.setFromMatrixPosition(e.matrixWorld),this.raycaster.ray.direction.set(0,0,-1).applyMatrix4(this.workingMatrix),this.raycaster.intersectObjects(this.asteroidGroup.children,!0).forEach((e=>{this.game.playerScored();let t=e.object.parent.parent.parent.parent.parent.parent;this.asteroidGroup.remove(t)}))}))}update(){if(this.stats.update(),this.earth.update(),this.renderer.xr.getSession()&&this.game.gameState===u.GameState.PLAYING){this.game.checkIfPlayerLost();let e=this.renderer.xr.getCamera(this.camera);this.clock.getElapsedTime()-this.prevTime>1&&(this.prevTime=this.clock.getElapsedTime(),this.asteroidGroup.updateEachSecond()),this.handleCameraMovement(),this.asteroidGroup.update(e)}this.renderer.render(this.scene,this.camera)}onResize(){this.renderer.setSize(window.innerWidth,window.innerHeight)}}},886:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sky=void 0;const s=i(212);class o extends s.CubeTextureLoader{constructor(){super()}loadSky(){let e=new Array(6).fill("assets/img/sky.jpg");return this.load(e)}}t.Sky=o},882:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0,t.Util=class{static random(e,t){return Math.random()*(t-e)+e}}}},0,[[752,666,216]]]);